
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cloudera启用kerberos | wzktravel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
<meta property="og:type" content="article">
<meta property="og:title" content="Cloudera启用kerberos">
<meta property="og:url" content="http://wzktravel.github.io/2016/01/19/Enabling-Kerberos-In-CDH/index.html">
<meta property="og:site_name" content="wzktravel">
<meta property="og:description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
<meta property="og:updated_time" content="2016-07-14T03:16:31.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cloudera启用kerberos">
<meta name="twitter:description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
  
    <link rel="alternative" href="/atom.xml" title="wzktravel" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">wzktravel</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="wzktravel.github.io">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-Enabling-Kerberos-In-CDH" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/19/Enabling-Kerberos-In-CDH/" class="article-date">
  <time datetime="2016-01-19T03:11:47.000Z" itemprop="datePublished">2016-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cloudera启用kerberos
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CDH&#x4E2D;&#x60F3;&#x4F7F;&#x7528;sentry&#x8FDB;&#x884C;&#x5B89;&#x5168;&#x7BA1;&#x7406;&#xFF0C;&#x4F46;&#x9700;&#x8981;&#x9996;&#x5148;&#x96C6;&#x6210;kerberos&#xFF0C;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;CDH&#x542F;&#x7528;kerberos&#x7684;&#x6B65;&#x9AA4;&#x4EE5;&#x53CA;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x3002;<br>&#x57FA;&#x672C;&#x6309;&#x7167;<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera&#x5B98;&#x7F51;: Enabling Kerberos Authentication Using the Wizard</a>&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;</p>
<p></p><p>&#x5982;&#x679C;&#x9700;&#x8981;&#x7981;&#x7528;kerberos&#xFF0C;&#x53C2;&#x8003;<a href="http://wzktravel.github.io/2016/03/05/Disable-kerberos-in-CDH/">CDH&#x7981;&#x7528;kerberos</a></p>
<p></p><p><strong>WARNING!!! &#x64CD;&#x4F5C;&#x9700;&#x8C28;&#x614E;&#xFF0C;&#x5751;&#x5F88;&#x591A;&#xFF0C;&#x6700;&#x597D;&#x5148;&#x5728;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x9884;&#x6F14;&#x3002;</strong><br><a id="more"></a></p>
<h2 id="&#x6574;&#x4F53;&#x6D41;&#x7A0B;&#x6982;&#x8FF0;"><a href="#&#x6574;&#x4F53;&#x6D41;&#x7A0B;&#x6982;&#x8FF0;" class="headerlink" title="&#x6574;&#x4F53;&#x6D41;&#x7A0B;&#x6982;&#x8FF0;"></a>&#x6574;&#x4F53;&#x6D41;&#x7A0B;&#x6982;&#x8FF0;</h2><h3 id="&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;"><a href="#&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;" class="headerlink" title="&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;"></a>&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;</h3><ol>
<li>&#x642D;&#x5EFA;MIT kerberos&#xFF0C;&#x6CE8;&#x610F;&#x4FDD;&#x5B58;cloudera-scm/admin&#x5BC6;&#x7801;&#x3002;</li>
<li>&#x96C6;&#x7FA4;&#x542F;&#x7528;kerberos</li>
<li>&#x5220;&#x9664;&#x6240;&#x6709;node manager&#x4E0A;yarn cache&#xFF0C;/yarn/nm/usercache/</li>
<li>&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;</li>
<li>&#x5468;&#x8FB9;&#x670D;&#x52A1;&#x914D;&#x7F6E;: opentsdb&#x5347;&#x7EA7;&#x5230;2.2&#xFF0C;&#x52A0;&#x5165;jaas, flume&#x914D;&#x7F6E;&#x5347;&#x7EA7;</li>
<li>&#x9A8C;&#x8BC1;MapReduce, spark, hive, impala, sqoop, oozie, shell&#x811A;&#x672C;&#x7684;&#x6B63;&#x786E;&#x6027;</li>
</ol>
<h3 id="&#x542F;&#x7528;&#x548C;&#x7981;&#x7528;kerberos&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x95EE;&#x9898;"><a href="#&#x542F;&#x7528;&#x548C;&#x7981;&#x7528;kerberos&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x95EE;&#x9898;" class="headerlink" title="&#x542F;&#x7528;&#x548C;&#x7981;&#x7528;kerberos&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x95EE;&#x9898;"></a>&#x542F;&#x7528;&#x548C;&#x7981;&#x7528;kerberos&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x95EE;&#x9898;</h3><ol>
<li>&#x5982;&#x679C;&#x6709;&#x8DE8;&#x96C6;&#x7FA4;&#x64CD;&#x4F5C;&#xFF0C;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x542F;&#x7528;kerberos&#xFF0C;distcp&#x547D;&#x4EE4;&#x65F6;&#x4F1A;&#x62A5;&#x9519;&#x3002;&#x53C2;&#x8003;<a href="https://issues.apache.org/jira/browse/HDFS-7037" target="_blank" rel="external">https://issues.apache.org/jira/browse/HDFS-7037</a></li>
<li>&#x96C6;&#x7FA4;&#x9700;&#x8981;&#x505C;&#x673A;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;</li>
<li>&#x7981;&#x7528;kerberos&#x540E;&#x6062;&#x590D;hbase&#x9700;&#x8981;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;</li>
<li>HA&#x4E0B;yarn&#x4E24;&#x4E2A;resource manager&#x90FD;&#x5904;&#x4E8E;standby&#x72B6;&#x6001;&#xFF0C;&#x53EA;&#x80FD;&#x7981;&#x7528;HA</li>
</ol>
<h2 id="mit-kerberos&#x642D;&#x5EFA;"><a href="#MIT-kerberos&#x642D;&#x5EFA;" class="headerlink" title="MIT kerberos&#x642D;&#x5EFA;"></a>MIT kerberos&#x642D;&#x5EFA;</h2><p>&#x516C;&#x53F8;&#x5185;&#x90E8;&#x4F7F;&#x7528;&#x7684;&#x662F;<code>Microsoft Active Directory</code>&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x4E0D;&#x7ED9;&#x521B;&#x5EFA;&#x7528;&#x6237;&#x6743;&#x9650;&#xFF0C;&#x800C;&#x4E14;&#x7528;&#x6237;&#x540D;&#x5FC5;&#x987B;&#x7B26;&#x5408;&#x4E00;&#x5B9A;&#x683C;&#x5F0F;&#xFF0C;&#x4FEE;&#x6539;&#x73B0;&#x5B58;&#x96C6;&#x7FA4;&#x7684;&#x8D26;&#x53F7;&#x592A;&#x8FC7;&#x9EBB;&#x70E6;&#xFF0C;&#x6240;&#x4EE5;&#x81EA;&#x5DF1;&#x642D;&#x5EFA;&#x4E86;<code>MIT kerberos</code>&#x3002;<br>&#x53C2;&#x8003;<a href="http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs" target="_blank" rel="external">http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs</a></p>
<p>&#x5728;&#x8FD9;&#x7EAA;&#x5F55;&#x4E00;&#x4E0B;&#x7528;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x547D;&#x4EE4;&#xFF0C;&#x5177;&#x4F53;&#x914D;&#x7F6E;&#x548C;&#x6B65;&#x9AA4;&#x53C2;&#x8003;&#x4E0A;&#x6587;&#x3002;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># &#x5B89;&#x88C5;kerberos server</span></div><div class="line">yum install krb5-server -y</div><div class="line">yum install krb5-libs krb5-workstation -y</div><div class="line"></div><div class="line"><span class="comment"># &#x505C;&#x6B62;&#x670D;&#x52A1;</span></div><div class="line">service krb5kdc stop</div><div class="line">service kadmin stop</div><div class="line"></div><div class="line"><span class="comment"># &#x5220;&#x9664;&#x6570;&#x636E;&#x5E93;&#x6587;&#x4EF6;&#x548C;&#x4E00;&#x4E9B;&#x914D;&#x7F6E;</span></div><div class="line">rm <span class="_">-f</span> /var/kerberos/krb5kdc/principal*</div><div class="line">rm <span class="_">-f</span> /var/kerberos/krb5kdc/.k5.*</div><div class="line">rm <span class="_">-f</span> /etc/krb5.keytab</div><div class="line"></div><div class="line"><span class="comment"># &#x4FEE;&#x6539;&#x914D;&#x7F6E;</span></div><div class="line"><span class="comment">## &#x6CE8;&#x610F;&#x6700;&#x540E;&#x7684;*&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;</span></div><div class="line">vim /var/kerberos/krb5kdc/kadm5.acl</div><div class="line">vim /var/kerberos/krb5kdc/kdc.conf</div><div class="line"><span class="comment"># &#x6B64;&#x914D;&#x7F6E;&#x9700;&#x8981;&#x540C;&#x6B65;&#x5230;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;cloudera&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;cloudera&#x63A5;&#x7BA1;</span></div><div class="line">vim /etc/krb5.conf</div><div class="line"></div><div class="line"><span class="comment"># &#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;</span></div><div class="line">kdb5_util create -r HADOOP.COM <span class="_">-s</span></div><div class="line"></div><div class="line"><span class="comment"># &#x542F;&#x52A8;&#x670D;&#x52A1;</span></div><div class="line">service krb5kdc start</div><div class="line">service kadmin start</div><div class="line"></div><div class="line"><span class="comment"># &#x6DFB;&#x52A0;root&#x7528;&#x6237;</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">&quot;root\nroot&quot;</span> | kadmin.local -q <span class="string">&quot;addprinc root/admin&quot;</span></div><div class="line"></div><div class="line"><span class="comment"># &#x62BD;&#x53D6;&#x5BC6;&#x94A5;&#x5E76;&#x5C06;&#x5176;&#x50A8;&#x5B58;&#x5728;&#x672C;&#x5730; keytab &#x6587;&#x4EF6; /etc/krb5.keytab &#x4E2D;&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7531;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x62E5;&#x6709;&#xFF0C;&#x6240;&#x4EE5;&#x60A8;&#x5FC5;&#x987B;&#x662F; root &#x7528;&#x6237;&#x624D;&#x80FD;&#x5728; kadmin shell &#x4E2D;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;</span></div><div class="line">kadmin.local -q <span class="string">&quot;ktadd kadmin/admin&quot;</span></div><div class="line">klist -k /etc/krb5.keytab</div><div class="line"></div><div class="line"><span class="comment"># &#x751F;&#x6210;cloudera&#x4E2D;&#x4F7F;&#x7528;&#x7684;admin&#x8D26;&#x53F7;</span></div><div class="line">kadmin.local -q <span class="string">&quot;addprinc -pw cloudera cloudera-scm/admin@HADOOP.COM&quot;</span></div><div class="line"></div><div class="line"><span class="comment"># &#x751F;&#x6210;&#x7528;&#x6237;&#x8D26;&#x53F7;keytab</span></div><div class="line">kadmin.local -q <span class="string">&quot;xst -k <span class="variable">${USERNAME}</span>.keytab <span class="variable">${USERNAME}</span>@HADOOP.COM&quot;</span></div><div class="line"><span class="comment"># &#x5408;&#x5E76;keytab</span></div><div class="line">$ ktutil</div><div class="line">ktutil: rkt hdfs-unmerged.keytab</div><div class="line">ktutil: rkt HTTP.keytab</div><div class="line">ktutil: wkt hdfs.keytab</div><div class="line">ktutil: <span class="built_in">exit</span></div><div class="line"><span class="comment"># &#x4F7F;&#x7528;keytab&#x5207;&#x6362;&#x7528;&#x6237;</span></div><div class="line">kinit -k -t hdfs.keytab hdfs@HADOOP.COM  </div><div class="line">kinit -k -t hdfs.keytab hdfs</div><div class="line"></div><div class="line"><span class="comment"># &#x5220;&#x9664;principal&#xFF0C;&#x4E0D;&#x4EA4;&#x4E92;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x52A0;&apos;-force&apos;&#x53C2;&#x6570;</span></div><div class="line">kadmin.local -q <span class="string">&quot;delprinc <span class="variable">$princ</span>&quot;</span></div></pre></td></tr></table></figure></p>
<h3 id="whats-a-keytab-file"><a href="#What&#x2019;s-a-keytab-file" class="headerlink" title="What&#x2019;s a keytab file?"></a>What&#x2019;s a keytab file?</h3><blockquote>
<p>What&#x2019;s a keytab file?  It&#x2019;s basically a file that contains a table of user accounts, with an encrypted hash of the user&#x2019;s password.  Why have a keytab file?  Well, when you want a server process to automatically logon to Active Directory on startup, you have two options:  type the password (in clear text) into a config file somewhere, or store an encrypted hash of the password in a keytab file.</p>
</blockquote>
<h2 id="cdh&#x542F;&#x7528;kerberos"><a href="#CDH&#x542F;&#x7528;kerberos" class="headerlink" title="CDH&#x542F;&#x7528;kerberos"></a>CDH&#x542F;&#x7528;kerberos</h2><p>&#x53C2;&#x8003;<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera&#x5B98;&#x7F51;: Enabling Kerberos Authentication Using the Wizard</a></p>
<h3 id="&#x524D;&#x671F;&#x51C6;&#x5907;"><a href="#&#x524D;&#x671F;&#x51C6;&#x5907;" class="headerlink" title="&#x524D;&#x671F;&#x51C6;&#x5907;"></a>&#x524D;&#x671F;&#x51C6;&#x5907;</h3><h4 id="cdh-manager-server&#x4E0A;&#x5B89;&#x88C5;openldap-clients"><a href="#CDH-Manager-Server&#x4E0A;&#x5B89;&#x88C5;openldap-clients" class="headerlink" title="CDH Manager Server&#x4E0A;&#x5B89;&#x88C5;openldap-clients"></a>CDH Manager Server&#x4E0A;&#x5B89;&#x88C5;<code>openldap-clients</code></h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo yum <span class="keyword">install</span> openldap-clients</div></pre></td></tr></table></figure>
<h4 id="&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x673A;&#x5668;&#x4E0A;&#x5B89;&#x88C5;krb5-workstation-krb5-libs"><a href="#&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x673A;&#x5668;&#x4E0A;&#x5B89;&#x88C5;krb5-workstation-krb5-libs" class="headerlink" title="&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x673A;&#x5668;&#x4E0A;&#x5B89;&#x88C5;krb5-workstation, krb5-libs"></a>&#x96C6;&#x7FA4;&#x6240;&#x6709;&#x673A;&#x5668;&#x4E0A;&#x5B89;&#x88C5;<code>krb5-workstation, krb5-libs</code></h4><p>cloudera manager server&#x53EF;&#x4EE5;ssh&#x65E0;&#x5BC6;&#x7801;&#x767B;&#x9646;&#x5230;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> `cat /etc/hosts | fgrep 172 | awk <span class="string">&apos;{print $1}&apos;</span>`; <span class="keyword">do</span></div><div class="line">  sudo yum install krb5-workstation krb5-libs -y </div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<h4 id="&#x751F;&#x6210;cloudera&#x4E2D;&#x4F7F;&#x7528;&#x7684;admin&#x8D26;&#x53F7;"><a href="#&#x751F;&#x6210;cloudera&#x4E2D;&#x4F7F;&#x7528;&#x7684;admin&#x8D26;&#x53F7;" class="headerlink" title="&#x751F;&#x6210;cloudera&#x4E2D;&#x4F7F;&#x7528;&#x7684;admin&#x8D26;&#x53F7;"></a>&#x751F;&#x6210;cloudera&#x4E2D;&#x4F7F;&#x7528;&#x7684;admin&#x8D26;&#x53F7;</h4><p>&#x5BC6;&#x7801;&#x8981;&#x8BB0;&#x7262;&#xFF0C;&#x6B64;&#x8D26;&#x53F7;&#x9700;&#x8981;&#x6709;&#x6743;&#x9650;&#x521B;&#x5EFA;&#x5176;&#x4ED6;&#x8D26;&#x53F7;</p>
<blockquote>
<p>Specifically, the Cloudera Manager Server must have a Kerberos principal that has privileges to create other accounts.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin.local -q <span class="string">&quot;addprinc -pw &lt;Password&gt; cloudera-scm/admin@YOUR-LOCAL-REALM.COM&quot;</span></div></pre></td></tr></table></figure>
<h3 id="cdh&#x542F;&#x7528;kerberos"><a href="#CDH&#x542F;&#x7528;kerberos-1" class="headerlink" title="CDH&#x542F;&#x7528;kerberos"></a>CDH&#x542F;&#x7528;kerberos</h3><p>&#x5728;CDH&#x7BA1;&#x7406;&#x9875;&#x9762;&#xFF0C;&#x96C6;&#x7FA4;&#x540D;&#x79F0;&#x53F3;&#x4FA7;&#x7684;&#x5C0F;&#x4E09;&#x89D2;&#x4E0B;&#x62C9;&#x83DC;&#x5355;&#x4E2D;&#xFF0C;&#x9009;&#x62E9;&#x300C;&#x542F;&#x7528;Kerberos&#x300D;&#xFF0C;&#x7136;&#x540E;&#x6309;<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_s4_kerb_wizard.html" target="_blank" rel="external">Enabling Kerberos Using the Wizard</a>&#x4E00;&#x6B65;&#x6B65;&#x64CD;&#x4F5C;&#x5373;&#x53EF;&#x3002;</p>
<p><strong> &#x9488;&#x5BF9;yarn&#x914D;&#x7F6E;&#xFF0C;&#x9700;&#x8981;&#x505A;&#x4E0B;&#x9762;&#x7684;&#x4FEE;&#x6539;&#xFF1A;</strong><br>&#x914D;&#x7F6E;&#x6587;&#x4EF6;container-executor.cfg</p>
<ol>
<li><code>min.user.id</code>: &#x5141;&#x8BB8;&#x7684;&#x6700;&#x5C0F; Linux &#x7528;&#x6237; ID, &#x7528;&#x4E8E;&#x963B;&#x6B62;&#x5176;&#x4ED6;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;1000&#x3002;</li>
<li><code>allowed.system.users</code>: &#x660E;&#x786E;&#x5217;&#x5165;&#x767D;&#x540D;&#x5355;&#x4EE5;&#x5141;&#x8BB8;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x7684;&#x7528;&#x6237;&#x5217;&#x8868;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;&#x8BBE;&#x7F6E;&#x5C06; ID &#x4F4E;&#x4E8E;&#x201C;&#x6700;&#x5C0F;&#x7528;&#x6237; ID&#x201D;&#x8BBE;&#x7F6E;&#x7684;&#x7528;&#x6237;&#x5217;&#x5165;&#x767D;&#x540D;&#x5355;&#x3002;</li>
<li><code>banned.users</code>: &#x7981;&#x6B62;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x7684;&#x7528;&#x6237;&#x5217;&#x8868;&#x3002;</li>
<li>&#x683C;&#x5F0F;&#x5316;resourcemanager state store</li>
</ol>
<blockquote>
<p> Important:<br>If you have enabled YARN Resource Manager HA in your non-secure cluster, you should clear the StateStore znode in ZooKeeper before enabling Kerberos. To do this:</p>
<ol>
<li>Go to the Cloudera Manager Admin Console home page, click to the right of the YARN service and select Stop.</li>
<li>When you see a Finished status, the service has stopped.</li>
<li>Go to the YARN service and select Actions &gt; Format State Store.</li>
<li>When the command completes, click Close.</li>
</ol>
</blockquote>
<h2 id="&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;"><a href="#&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;" class="headerlink" title="&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;"></a>&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;</h2><h3 id="&#x521B;&#x5EFA;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;"><a href="#&#x521B;&#x5EFA;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;" class="headerlink" title="&#x521B;&#x5EFA;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;"></a>&#x521B;&#x5EFA;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin<span class="selector-class">.local</span> -<span class="selector-tag">q</span> <span class="string">&quot;addprinc hdfs@HADOOP.COM&quot;</span></div></pre></td></tr></table></figure>
<p>&#x5BC6;&#x7801;&#x5F3A;&#x5EA6;&#x5927;&#x4E00;&#x70B9;&#xFF0C;&#x6B64;&#x7528;&#x6237;&#x62E5;&#x6709;hdfs&#x4E0A;&#x6240;&#x6709;&#x6743;&#x9650;&#x3002;</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">kinit</span> <span class="selector-tag">hdfs</span>@<span class="keyword">HADOOP</span>.<span class="keyword">COM</span></div></pre></td></tr></table></figure>
<p>&#x5207;&#x6362;&#x5230;&#x6B64;&#x7528;&#x6237;&#x3002;</p>
<h3 id="&#x6307;&#x5B9A;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7EC4;"><a href="#&#x6307;&#x5B9A;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7EC4;" class="headerlink" title="&#x6307;&#x5B9A;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7EC4;"></a>&#x6307;&#x5B9A;hdfs&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7EC4;</h3><blockquote>
<p>To designate a group of superusers instead of using the default hdfs account, follow these steps:</p>
<ol>
<li>Navigate to the <strong>HDFS Service</strong> &gt; <strong>Configuration</strong> tab.</li>
<li>In the Search field, type <strong>Superuser</strong> to display the <strong>Superuser Group</strong> property.</li>
<li>Change the value from the default supergroup to the appropriate group name for your environment.</li>
<li>Click <strong>Save Changes</strong>.<br>For this change to take effect, you must restart the cluster.</li>
</ol>
</blockquote>
<h3 id="&#x4E3A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x521B;&#x5EFA;principal"><a href="#&#x4E3A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x521B;&#x5EFA;principal" class="headerlink" title="&#x4E3A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x521B;&#x5EFA;principal"></a>&#x4E3A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x521B;&#x5EFA;principal</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin<span class="selector-class">.local</span> -<span class="selector-tag">q</span> <span class="string">&quot;addprinc user@HADOOP.COM&quot;</span></div></pre></td></tr></table></figure>
<p><a href="http://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_s7_prepare_cluster.html" target="_blank" rel="external">Prepare the Cluster for Each User</a></p>
<blockquote>
<p>Each account must have a user ID that is greater than or equal to 1000. In the /etc/hadoop/conf/taskcontroller.cfg file, the default setting for the banned.users property is mapred, hdfs, and bin to prevent jobs from being submitted via those user accounts. The default setting for the min.user.id property is 1000 to prevent jobs from being submitted with a user ID less than 1000, which are conventionally Unix super users.</p>
</blockquote>
<h2 id="&#x5468;&#x8FB9;&#x670D;&#x52A1;"><a href="#&#x5468;&#x8FB9;&#x670D;&#x52A1;" class="headerlink" title="&#x5468;&#x8FB9;&#x670D;&#x52A1;"></a>&#x5468;&#x8FB9;&#x670D;&#x52A1;</h2><h3 id="opentsdb&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hbase"><a href="#opentsdb&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hbase" class="headerlink" title="opentsdb&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hbase"></a>opentsdb&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hbase</h3><p>&#x4E0B;&#x8F7D;&#x4F7F;&#x7528;&#x6700;&#x65B0;&#x7684;opentsdb 2.2&#x7248;&#x672C;&#xFF0C;&#x6B64;&#x524D;&#x7248;&#x672C;&#x4E2D;&#x96C6;&#x6210;&#x7684;AsyncHBase&#x65E0;kerberos&#x9A8C;&#x8BC1;&#x529F;&#x80FD;&#x3002;</p>
<ol>
<li><p>&#x5728;/etc/opentsdb/opentsdb.conf&#x4E2D;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x914D;&#x7F6E;:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hbase<span class="selector-class">.security</span><span class="selector-class">.auth</span><span class="selector-class">.enable</span>=true</div><div class="line">hbase<span class="selector-class">.security</span><span class="selector-class">.authentication</span>=kerberos</div><div class="line">hbase<span class="selector-class">.kerberos</span><span class="selector-class">.regionserver</span><span class="selector-class">.principal</span>=hbase/_HOST@HADOOP<span class="selector-class">.COM</span></div><div class="line">hbase<span class="selector-class">.sasl</span><span class="selector-class">.clientconfig</span>=Client</div></pre></td></tr></table></figure>
</li>
<li><p>&#x65B0;&#x5EFA;/etc/opentsdb/jaas.conf&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B;:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Client {</div><div class="line">  com.sun.security.auth.<span class="built_in">module</span>.Krb5LoginModule required</div><div class="line">  useKeyTab=<span class="literal">false</span></div><div class="line">  useTicketCache=<span class="literal">true</span>;</div><div class="line">};</div></pre></td></tr></table></figure>
</li>
<li><p>&#x5728;opentsdb&#x542F;&#x52A8;&#x9879;&#x4E2D;&#x6DFB;&#x52A0;<code>-Djava.security.auth.login.config=/etc/opentsdb/jaas.conf</code>&#x3002;</p>
</li>
<li>&#x8FD0;&#x884C;<code>kinit</code>&#x547D;&#x4EE4;&#xFF1A;<code>kinit -k -t hbase.keytab hbase</code></li>
<li>&#x91CD;&#x542F;opentsdb</li>
</ol>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;keytab&#x65B9;&#x5F0F;&#x4F1A;&#x62A5;&#x65E0;&#x6CD5;&#x8FDE;&#x63A5;hbase&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;<code>useTicketCache</code>&#xFF0C;&#x5E76;&#x624B;&#x52A8;<code>kinit</code>&#x3002;</p>
<blockquote>
<p>KerberosClientAuthProvider: Could not login: the client is being asked for a password, but the  client code does not currently support obtaining a password from the user. Make sure that the client is configured to use a ticket cache (using the JAAS configuration setting &#x2018;useTicketCache=true)&#x2019; and restart the client. If you still get this message after that, the TGT in the ticket cache has expired and must be manually refreshed. To do so, first determine if you are using a password or a keytab. If the former, run kinit in a Unix shell in the environment of the user who is running this asynchbase client using the command &#x2018;kinit <princ>&#x2018; (where <princ> is the name of the client&#x2019;s Kerberos principal). If the latter, do &#x2018;kinit -k -t <keytab> <princ>&#x2018; (where <princ> is the name of the Kerberos principal, and <keytab> is the location of the keytab file). After manually refreshing your cache, restart this client. If you continue to see this message after manually refreshing your cache, ensure that your KDC host&#x2019;s clock is in sync with this host&#x2019;s clock.</keytab></princ></princ></keytab></princ></princ></p>
</blockquote>
<h3 id="flume&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hdfs"><a href="#flume&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hdfs" class="headerlink" title="flume&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hdfs"></a>flume&#x8FDE;&#x63A5;&#x96C6;&#x6210;&#x4E86;kerberos&#x7684;hdfs</h3><p>&#x5C06;hdfs.keytab&#x590D;&#x5236;&#x5230;flume conf&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x5E76;&#x5728;flume.hdfs.conf&#x4E2D;&#x914D;&#x7F6E;hdfs-sink&#xFF0C;&#x6DFB;&#x52A0;<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a1<span class="selector-class">.sinks</span><span class="selector-class">.hdfs-sink</span><span class="selector-class">.hdfs</span><span class="selector-class">.kerberosPrincipal</span> = hdfs@HADOOP<span class="selector-class">.COM</span></div><div class="line">a1<span class="selector-class">.sinks</span><span class="selector-class">.hdfs-sink</span><span class="selector-class">.hdfs</span><span class="selector-class">.kerberosKeytab</span> = ./conf/hdfs.keytab</div></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F;keytab&#x4F4D;&#x7F6E;&#x3002;</p>
<h2 id="&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x548C;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;"><a href="#&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x548C;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x548C;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;"></a>&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x548C;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;</h2><h3 id="1-kinit-cannot-find-kdc-for-requested-realm-while-getting-initial-credentials"><a href="#1-kinit-Cannot-find-KDC-for-requested-realm-while-getting-initial-credentials" class="headerlink" title="1. kinit: Cannot find KDC for requested realm while getting initial credentials"></a>1. kinit: Cannot find KDC for requested realm while getting initial credentials</h3><p>krb5.conf&#x914D;&#x7F6E;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x8651;cloudera&#x63A5;&#x7BA1;krb5.conf</p>
<h3 id="2-kinit-kdc-reply-did-not-match-expectations-while-getting-initial-credentials"><a href="#2-kinit-KDC-reply-did-not-match-expectations-while-getting-initial-credentials" class="headerlink" title="2. kinit: KDC reply did not match expectations while getting initial credentials"></a>2. kinit: KDC reply did not match expectations while getting initial credentials</h3><p>kerberos&#x914D;&#x7F6E;&#x65F6;&#x57DF;&#x540D;&#x8981;&#x5927;&#x5199;</p>
<h3 id="3-&#x673A;&#x5668;hostname&#x5F15;&#x8D77;&#x7684;&#x6700;&#x5927;&#x7684;&#x5751;"><a href="#3-&#x673A;&#x5668;hostname&#x5F15;&#x8D77;&#x7684;&#x6700;&#x5927;&#x7684;&#x5751;&#xFF01;" class="headerlink" title="3. &#x673A;&#x5668;hostname&#x5F15;&#x8D77;&#x7684;&#x6700;&#x5927;&#x7684;&#x5751;&#xFF01;"></a>3. &#x673A;&#x5668;hostname&#x5F15;&#x8D77;&#x7684;&#x6700;&#x5927;&#x7684;&#x5751;&#xFF01;</h3><p>&#x75C7;&#x72B6;: &#x96C6;&#x7FA4;&#x4E2D;hdfs&#x7B49;&#x670D;&#x52A1;&#x65E0;&#x6CD5;&#x542F;&#x52A8;,&#x62A5;&#x9519;</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">java.io.IOException: Login failure <span class="keyword">for</span> hdfs/vlnx107010@HADOOP.COM <span class="keyword">from</span> keytab hdfs.keytab: javax.security.auth.login.LoginException: Client <span class="keyword">not</span> found <span class="keyword">in</span> Kerberos database (<span class="number">6</span>) - CLIENT_NOT_FOUND</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytab(UserGroupInformation.java:<span class="number">976</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.security.SecurityUtil.login(SecurityUtil.java:<span class="number">243</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.loginAsNameNodeUser(NameNode.java:<span class="number">613</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:<span class="number">632</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">810</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">794</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:<span class="number">1487</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:<span class="number">1555</span>)</div><div class="line">Caused <span class="keyword">by</span>: javax.security.auth.login.LoginException: Client <span class="keyword">not</span> found <span class="keyword">in</span> Kerberos database (<span class="number">6</span>) - CLIENT_NOT_FOUND</div><div class="line">    <span class="keyword">at</span> com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:<span class="number">804</span>)</div><div class="line">    <span class="keyword">at</span> com.sun.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:<span class="number">617</span>)</div><div class="line">    <span class="keyword">at</span> sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</div><div class="line">    <span class="keyword">at</span> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>)</div><div class="line">    <span class="keyword">at</span> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</div><div class="line">    <span class="keyword">at</span> java.lang.reflect.Method.invoke(Method.java:<span class="number">497</span>)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext.invoke(LoginContext.java:<span class="number">755</span>)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext.access$<span class="number">000</span>(LoginContext.java:<span class="number">195</span>)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext$<span class="number">4.</span><span class="built_in">run</span>(LoginContext.java:<span class="number">682</span>)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext$<span class="number">4.</span><span class="built_in">run</span>(LoginContext.java:<span class="number">680</span>)</div><div class="line">    <span class="keyword">at</span> java.security.AccessController.doPrivileged(Native Method)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:<span class="number">680</span>)</div><div class="line">    <span class="keyword">at</span> javax.security.auth.login.LoginContext.login(LoginContext.java:<span class="number">587</span>)</div><div class="line">    <span class="keyword">at</span> org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytab(UserGroupInformation.java:<span class="number">967</span>)</div><div class="line">    ... <span class="number">7</span> more</div><div class="line">Caused <span class="keyword">by</span>: KrbException: Client <span class="keyword">not</span> found <span class="keyword">in</span> Kerberos database (<span class="number">6</span>) - CLIENT_NOT_FOUND</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.KrbAsRep.&lt;init&gt;(KrbAsRep.java:<span class="number">82</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.KrbAsReqBuilder.send(KrbAsReqBuilder.java:<span class="number">316</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.KrbAsReqBuilder.action(KrbAsReqBuilder.java:<span class="number">361</span>)</div><div class="line">    <span class="keyword">at</span> com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:<span class="number">776</span>)</div><div class="line">    ... <span class="number">20</span> more</div><div class="line">Caused <span class="keyword">by</span>: KrbException: Identifier doesn&apos;t match expected value (<span class="number">906</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.internal.KDCRep.init(KDCRep.java:<span class="number">140</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.internal.ASRep.init(ASRep.java:<span class="number">64</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.internal.ASRep.&lt;init&gt;(ASRep.java:<span class="number">59</span>)</div><div class="line">    <span class="keyword">at</span> sun.security.krb5.KrbAsRep.&lt;init&gt;(KrbAsRep.java:<span class="number">60</span>)</div><div class="line">    ... <span class="number">23</span> more</div></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">klist -k hdfs<span class="selector-class">.keytab</span></div><div class="line">Keytab name: FILE:hdfs<span class="selector-class">.keytab</span></div><div class="line">KVNO Principal</div><div class="line">---- --------------------------------------------------------------------------</div><div class="line">   <span class="number">2</span> HTTP/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> HTTP/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> HTTP/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> HTTP/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> hdfs/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> hdfs/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> hdfs/VLNX107010@HADOOP<span class="selector-class">.COM</span></div><div class="line">   <span class="number">2</span> hdfs/VLNX107010@HADOOP.COM</div></pre></td></tr></table></figure>
<p>&#x6CE8;&#x610F;hdfs&#x65E5;&#x5FD7;&#x4E2D;principal&#x4E3A;<code>hdfs/vlnx107010@HADOOP.COM</code>&#xFF0C;&#x4F46;&#x5728;&#x751F;&#x6210;&#x7684;hdfs.keytab&#x4E2D;&#x4E3A;<code>hdfs/VLNX107010@HADOOP.COM</code>&#xFF0C;&#x533A;&#x522B;&#x5C31;&#x662F;&#x57DF;&#x540D;&#x7684;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x5728;kerberos&#x4E2D;&#x662F;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8BA4;&#x8BC1;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x6B64;&#x96C6;&#x7FA4;&#x7684;hostname&#x548C;/etc/hosts&#x4E2D;&#x90FD;&#x662F;&#x5927;&#x5199;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x7B2C;&#x4E00;&#x60F3;&#x6CD5;&#x662F;&#x60F3;&#x529E;&#x6CD5;&#x5C06;hdfs&#x7684;principal&#x6539;&#x4E3A;&#x5C0F;&#x5199;&#x7684;&#xFF0C;&#x7ECF;&#x8FC7;&#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x548C;&#x67E5;&#x9605;&#x8D44;&#x6599;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x4E0D;&#x53EF;&#x884C;&#xFF0C;&#x53C2;&#x8003;<a href="https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475" target="_blank" rel="external">https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475</a></p>
<blockquote>
<p>Hadoop in general expects that your hostnames and domain names are all lowercase.  When Kerberos is introduced, this becomes important.  While it is possible to override this behavior (of expecting lowercase) by doing manual configuration, I recommend ensuring via /etc/hosts or DNS that your host and domain are lower case.  After that is corrected, regenerate credentials and that should correct the problem.</p>
</blockquote>
<p>&#x8FDB;&#x884C;&#x4E86;&#x66F4;&#x4E3A;&#x82E6;&#x903C;&#x7684;&#x4E09;&#x6B65;&#xFF1A;<br>1&#x3002;&#x4FEE;&#x6539;&#x96C6;&#x7FA4;&#x7684;hostname&#x548C;/etc/hosts&#x4E86;&#xFF0C;&#x4FEE;&#x6539;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x7684;/etc/hosts&#x540E;&#xFF0C;&#x6279;&#x91CF;&#x5904;&#x7406;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> HOST <span class="keyword">in</span> `cat /etc/hosts | fgrep 172 | awk <span class="string">&apos;{print $2}&apos;</span>`; <span class="keyword">do</span></div><div class="line">    scp /etc/hosts <span class="variable">${HOST}</span>:/etc/hosts</div><div class="line">    ssh <span class="variable">${HOST}</span> <span class="string">&quot;hostname <span class="variable">${HOST}</span> &amp;&amp; sed -i &apos;s/VLNX/vlnx/g&apos; /etc/sysconfig/network&quot;</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>&#x5728;cloudera&#x4E2D;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x6B65;&#x9AA4;disable kerberos&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x914D;&#x7F6E;&#x4E00;&#x6B21;&#x3002;&#x53D1;&#x73B0;&#x8FD8;&#x662F;&#x4E0D;&#x884C;&#xFF0C;&#x5728;kerberos&#x4E2D;&#x751F;&#x6210;&#x7684;&#x7528;&#x6237;&#x8FD8;&#x662F;&#x5927;&#x5199;&#x7684;&#x3002;</p>
<p>2&#x3002;&#x4E8E;&#x662F;&#x4FEE;&#x6539;kerberos&#x4E2D;&#x8D26;&#x53F7;&#x540D;&#xFF0C;&#x5C06;VLNX&#x4FEE;&#x6539;&#x4E3A;vlnx&#x3002;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> P <span class="keyword">in</span> `kadmin.local -q <span class="string">&quot;listprincs&quot;</span> | fgrep VLNX` ; <span class="keyword">do</span></div><div class="line">    UP=`<span class="built_in">echo</span> <span class="variable">$P</span> | sed <span class="string">&apos;s/VLNX/vlnx/g&apos;</span> ` </div><div class="line">    kadmin.local -q <span class="string">&quot;renprinc -force <span class="variable">${P}</span> <span class="variable">${UP}</span>&quot;</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>&#x8FD8;&#x662F;&#x4E0D;&#x884C;&#xFF0C;&#x8FD9;&#x662F;&#x5728;&#x6211;&#x9884;&#x6599;&#x4E2D;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x751F;&#x6210;&#x7684;keytab&#x4E2D;&#x8D26;&#x53F7;&#x540D;&#x8FD8;&#x662F;&#x5927;&#x5199;&#x7684;&#x3002;&#x53C2;&#x8003;&#x4E0A;&#x9762;&#x7684;<code>klist -k hdfs.keytab</code>&#x547D;&#x4EE4;&#x7ED3;&#x679C;&#x3002;</p>
<p>3&#x3002;&#x7EC8;&#x6781;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x6765;&#x4E86;&#x3002;cloudera&#x4E2D;kerberos&#x751F;&#x6210;&#x51ED;&#x8BC1;&#x53D6;&#x7684;&#x662F;&#x5728;cloudera&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x4FEE;&#x6539;cloudera&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x5728;&#x9875;&#x9762;&#x4E2D;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x6570;&#x636E;&#x5E93;&#x4FEE;&#x6539;&#x3002;</p>
<p>cloudera&#x81EA;&#x8EAB;&#x4F7F;&#x7528;&#x7684;&#x6570;&#x636E;&#x5E93;&#x662F;<code>postgres</code>&#xFF0C;database&#x4E3A;<code>scm</code>&#xFF0C;&#x5BC6;&#x7801;&#x5728;<code>/etc/cloudera-scm-server/db.properties</code>&#x4E2D;&#x3002;&#x901A;&#x8FC7;<code>psql -h localhost -p 7432 -U scm</code>&#x8FDB;&#x5165;postgres cli&#x3002;</p>
<p>&#x67E5;&#x770B;hosts&#xFF0C;&#x5E76;&#x4FEE;&#x6539;name<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">scm=&gt;  select host_id,host_identifier,name,ip_address from hosts;</div><div class="line"> host_id |           host_identifier            |    name    |   ip_address</div><div class="line">---------+--------------------------------------+------------+----------------</div><div class="line">       <span class="number">1</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107009 | <span class="number">192.1</span><span class="number">.107</span><span class="number">.9</span></div><div class="line">       <span class="number">2</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107010 | <span class="number">192.1</span><span class="number">.107</span><span class="number">.10</span></div><div class="line">       <span class="number">9</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103122 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.122</span></div><div class="line">       <span class="number">7</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103124 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.124</span></div><div class="line">       <span class="number">8</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103125 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.125</span></div><div class="line">       <span class="number">6</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103126 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.126</span></div><div class="line">       <span class="number">5</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103127 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.127</span></div><div class="line">       <span class="number">4</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103128 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.128</span></div><div class="line">      <span class="number">12</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103129 | <span class="number">192.1</span><span class="number">.103</span><span class="number">.129</span></div><div class="line">       <span class="number">3</span> | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107011 | <span class="number">192.1</span><span class="number">.107</span><span class="number">.11</span></div><div class="line"></div><div class="line">scm=&gt;  update hosts set name = &apos;vlnx107011&apos; where host_id = <span class="number">3</span>;</div></pre></td></tr></table></figure></p>
<p>&#x5168;&#x90E8;&#x66F4;&#x65B0;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x91CD;&#x542F;cloudera-scm-server&#x548C;&#x6240;&#x6709;&#x673A;&#x5668;&#x7684;cloudera-scm-agent&#xFF0C;&#x7136;&#x540E;&#x518D;&#x91CD;&#x65B0;&#x6765;&#x4E00;&#x904D;&#x3002;</p>
<h3 id="4-&#x8DE8;&#x96C6;&#x7FA4;distcp&#x5F02;&#x5E38;"><a href="#4-&#x8DE8;&#x96C6;&#x7FA4;distcp&#x5F02;&#x5E38;" class="headerlink" title="4. &#x8DE8;&#x96C6;&#x7FA4;distcp&#x5F02;&#x5E38;"></a>4. &#x8DE8;&#x96C6;&#x7FA4;distcp&#x5F02;&#x5E38;</h3><p>&#x4ECE;&#x4E00;&#x4E2A;&#x975E;&#x5B89;&#x5168;&#x96C6;&#x7FA4;&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x5230;&#x5B89;&#x5168;&#x96C6;&#x7FA4;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x53C2;&#x8003;<a href="https://issues.apache.org/jira/browse/HDFS-7037" target="_blank" rel="external">https://issues.apache.org/jira/browse/HDFS-7037</a><br>&#x6B64;&#x95EE;&#x9898;&#x8FD8;&#x672A;&#x5F97;&#x5230;&#x89E3;&#x51B3;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x6709;&#x4E24;&#x4E2A;&#x96C6;&#x7FA4;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x8FDB;&#x884C;&#x96C6;&#x7FA4;&#x95F4;&#x6570;&#x636E;&#x4EA4;&#x4E92;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x540E;&#x672A;&#x542F;&#x7528;kerberos&#x3002;</p>
<h3 id="5-yarn&#x4E2D;&#x4EFB;&#x52A1;&#x62A5;&#x9519;&#x7528;&#x6237;id&#x5C0F;&#x4E8E;1000"><a href="#5-yarn&#x4E2D;&#x4EFB;&#x52A1;&#x62A5;&#x9519;&#x201D;&#x7528;&#x6237;id&#x5C0F;&#x4E8E;1000&#x201D;" class="headerlink" title="5. yarn&#x4E2D;&#x4EFB;&#x52A1;&#x62A5;&#x9519;&#x201D;&#x7528;&#x6237;id&#x5C0F;&#x4E8E;1000&#x201D;"></a>5. yarn&#x4E2D;&#x4EFB;&#x52A1;&#x62A5;&#x9519;&#x201D;&#x7528;&#x6237;id&#x5C0F;&#x4E8E;1000&#x201D;</h3><p>Diagnostics: Application application_1453449921629_0005 initialization failed (exitCode=255) with output: Requested user hdfs is not whitelisted and has id 496, which is below the minimum allowed 1000</p>
<p>&#x7528;&#x6237;&#x5728;client&#x4E0A;id&#x4E0D;&#x80FD;&#x5C0F;&#x4E8E;1000&#xFF0C;&#x53EF;&#x4EE5;&#x5728;<code>container-executor.cfg</code>&#x914D;&#x7F6E;<code>min.user.id</code>&#xFF0C;&#x6216;&#x8005;&#x4FEE;&#x6539;linux&#x7684;<code>/etc/login.defs</code>&#x4E2D;<code>UID_MIN</code>&#x5927;&#x5C0F;&#x3002;</p>
<h3 id="6-yarn&#x4E2D;&#x8DD1;&#x4EFB;&#x52A1;&#x65F6;&#x62A5;&#x9519;user-user-not-found"><a href="#6-yarn&#x4E2D;&#x8DD1;&#x4EFB;&#x52A1;&#x65F6;&#x62A5;&#x9519;User-lt-user-gt-not-found" class="headerlink" title="6. yarn&#x4E2D;&#x8DD1;&#x4EFB;&#x52A1;&#x65F6;&#x62A5;&#x9519;User &lt;user&gt; not found"></a>6. yarn&#x4E2D;&#x8DD1;&#x4EFB;&#x52A1;&#x65F6;&#x62A5;&#x9519;<code>User &lt;user&gt; not found</code></h3><p>&#x5F02;&#x5E38;&#x4FE1;&#x606F;: <code>Diagnostics: Application application_1453449921629_0004 initialization failed (exitCode=255) with output: User usertest not found</code></p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;&#x9700;&#x8981;&#x6240;&#x6709;nodemanager&#x4E0A;&#x6709;&#x76F8;&#x5E94;&#x7684;&#x7528;&#x6237;<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">useradd -m usertest &amp;&amp; echo <span class="variable">&lt;password&gt;</span> |<span class="string"> passwd --stdin usertest</span></div></pre></td></tr></table></figure></p>
<h3 id="7-yarn&#x62A5;&#x9519;cant-create-directory-yarnnmusercache-permission-denied"><a href="#7-yarn&#x62A5;&#x9519;Can-39-t-create-directory-yarn-nm-usercache-Permission-denied" class="headerlink" title="7. yarn&#x62A5;&#x9519;Can&apos;t create directory /yarn/nm/usercache/... Permission denied"></a>7. yarn&#x62A5;&#x9519;<code>Can&apos;t create directory /yarn/nm/usercache/... Permission denied</code></h3><p>&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#xFF1A; <code>Can&apos;t create directory /yarn/nm/usercache/usertest/appcache/application_1453549225084_0001 - Permission denied. Did not create any app directories</code></p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;<br>&#x624B;&#x52A8;&#x5220;&#x9664;&#x6240;&#x6709;nodemanager&#x7684;<code>/yarn/nm/usercache/</code>&#x4E0B;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x4E0D;&#x80FD;&#x5220;&#x9664;&#x6574;&#x4E2A;usercache&#x76EE;&#x5F55;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x62A5;<code>Failed to create directory /yarn/nm/usercache/usertest - No such file or directory</code>&#x3002;&#x62A5;&#x8FD9;&#x4E2A;&#x9519;&#x65F6;&#xFF0C;&#x53EA;&#x8981;&#x518D;&#x65B0;&#x5EFA;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;chown&#x7ED9;yarn&#x3002;</p>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="http://community.cloudera.com/t5/Batch-Processing-and-Workflow/Can-t-create-directory-yarn-nm-usercache-urika-appcache/td-p/24891" target="_blank" rel="external">http://community.cloudera.com/t5/Batch-Processing-and-Workflow/Can-t-create-directory-yarn-nm-usercache-urika-appcache/td-p/24891</a></p>
<blockquote>
<p>Fix was to remove or move the urika cache directory from all the nodes with (computes in my case).  Seems that these directories will get re-created during a run.<br>Bug when you go from simlpe AUTH to kerberos AUTH; the cache directories will not work if created under simple AUTH.</p>
</blockquote>
<h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><ol>
<li><a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera&#x5B98;&#x7F51;: Enabling Kerberos Authentication Using the Wizard</a></li>
<li><a href="http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs" target="_blank" rel="external">HDFS&#x914D;&#x7F6E;Kerberos&#x8BA4;&#x8BC1;</a></li>
<li><a href="http://www.aboutyun.com/thread-13346-1-1.html" target="_blank" rel="external">CDH&#x914D;&#x7F6E;Kerberos&#x540E;&#x7684;&#x95EE;&#x9898;</a></li>
<li><a href="http://www.aikaiyuan.com/1380.html" target="_blank" rel="external">Linux&#x52A0;&#x5165;&#x57DF;kinit&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x9519;&#x8BEF;&#x89E3;&#x7B54;</a></li>
<li><a href="http://www.itadmintools.com/2011/07/creating-kerberos-keytab-files.html" target="_blank" rel="external">Creating Kerberos Keytab Files Compatible with Active Directory</a></li>
<li><a href="https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475" target="_blank" rel="external">cloudera kerberos hostname&#x5927;&#x5C0F;&#x5199;&#x95EE;&#x9898;</a></li>
<li><a href="http://linsec.ca/using_kerberos_5_for_single_sign-on_authentication/" target="_blank" rel="external">Using kerberos5 for single sign on authentication</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://wzktravel.github.io/2016/01/19/Enabling-Kerberos-In-CDH/" data-id="ciqrrv6mf00132x9kjeky24l8" class="article-share-link">分享到</a>
      

      
        <a href="http://wzktravel.github.io/2016/01/19/Enabling-Kerberos-In-CDH/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CDH/">CDH</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kerberos/">kerberos</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/01/19/hdfs-add-nodes-dynamically/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          HFDS修改备份系数和动态增删节点
        
      </div>
    </a>
  
  
    <a href="/2016/01/15/ntp-server/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">ntp server搭建</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2016/01/19/Enabling-Kerberos-In-CDH/" data-title="Cloudera启用kerberos" data-url="http://wzktravel.github.io/2016/01/19/Enabling-Kerberos-In-CDH/"></div>
  </section>
</section>
      
      <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDH/">CDH</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azkaban/">azkaban</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cdh/">cdh</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloudera/">cloudera</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdfs/">hdfs</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/">hive</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/">jvm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kerberos/">kerberos</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/">log</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lzo/">lzo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ntp/">ntp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/">quartz</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/queue/">queue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">scala</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sed/">sed</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentry/">sentry</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/">spark</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/squid/">squid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yarn/">yarn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/任务调度/">任务调度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调度/">调度</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CDH/" style="font-size: 15px;">CDH</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/azkaban/" style="font-size: 10px;">azkaban</a> <a href="/tags/cdh/" style="font-size: 11.67px;">cdh</a> <a href="/tags/cloudera/" style="font-size: 11.67px;">cloudera</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/flume/" style="font-size: 11.67px;">flume</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 11.67px;">github</a> <a href="/tags/hadoop/" style="font-size: 20px;">hadoop</a> <a href="/tags/hdfs/" style="font-size: 13.33px;">hdfs</a> <a href="/tags/hive/" style="font-size: 11.67px;">hive</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/kerberos/" style="font-size: 13.33px;">kerberos</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/lzo/" style="font-size: 10px;">lzo</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/ntp/" style="font-size: 10px;">ntp</a> <a href="/tags/quartz/" style="font-size: 10px;">quartz</a> <a href="/tags/queue/" style="font-size: 10px;">queue</a> <a href="/tags/scala/" style="font-size: 13.33px;">scala</a> <a href="/tags/sed/" style="font-size: 10px;">sed</a> <a href="/tags/sentry/" style="font-size: 10px;">sentry</a> <a href="/tags/shell/" style="font-size: 18.33px;">shell</a> <a href="/tags/spark/" style="font-size: 13.33px;">spark</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/squid/" style="font-size: 10px;">squid</a> <a href="/tags/vim/" style="font-size: 11.67px;">vim</a> <a href="/tags/yarn/" style="font-size: 10px;">yarn</a> <a href="/tags/任务调度/" style="font-size: 10px;">任务调度</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/调度/" style="font-size: 10px;">调度</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/15/proxy-server/">搭建proxy伺服器</a>
          </li>
        
          <li>
            <a href="/2016/05/24/upgrade-cdh-to-5-7-0/">升级CDH到5.7.0</a>
          </li>
        
          <li>
            <a href="/2016/05/11/elasticsearch-reindex/">elasticsearch修改mapping重建索引</a>
          </li>
        
          <li>
            <a href="/2016/05/10/hadoop-management/">hadoop集群管理</a>
          </li>
        
          <li>
            <a href="/2016/05/04/azkaban-how-to-install-and-use/">azkaban的安装和使用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 wzktravel<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"wzktravel"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js"></script>

</div>
</body>
</html>
