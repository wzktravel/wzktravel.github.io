
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cloudera启用kerberos | wzktravel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
<meta property="og:type" content="article">
<meta property="og:title" content="Cloudera启用kerberos">
<meta property="og:url" content="http://wzktravel.github.io/2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/index.html">
<meta property="og:site_name" content="wzktravel">
<meta property="og:description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
<meta property="og:updated_time" content="2016-07-14T03:16:31.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cloudera启用kerberos">
<meta name="twitter:description" content="CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。基本按照Cloudera官网: Enabling Kerberos Authentication Using the Wizard进行操作。
如果需要禁用kerberos，参考CDH禁用kerberos
WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。">
  
    <link rel="alternative" href="/atom.xml" title="wzktravel" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">wzktravel</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="wzktravel.github.io">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-2016-01-19-Enabling-Kerberos-In-CDH" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/" class="article-date">
  <time datetime="2016-01-19T03:11:47.000Z" itemprop="datePublished">2016-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cloudera启用kerberos
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CDH中想使用sentry进行安全管理，但需要首先集成kerberos，下面介绍CDH启用kerberos的步骤以及遇到的问题。<br>基本按照<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera官网: Enabling Kerberos Authentication Using the Wizard</a>进行操作。</p>
<p></p><p>如果需要禁用kerberos，参考<a href="http://wzktravel.github.io/2016/03/05/Disable-kerberos-in-CDH/" target="_blank" rel="external">CDH禁用kerberos</a></p>
<p></p><p><strong>WARNING!!! 操作需谨慎，坑很多，最好先在测试环境预演。</strong><br><a id="more"></a></p>
<h2 id="整体流程概述"><a href="#整体流程概述" class="headerlink" title="整体流程概述"></a>整体流程概述</h2><h3 id="总结一下整个流程下来需要做的事情："><a href="#总结一下整个流程下来需要做的事情：" class="headerlink" title="总结一下整个流程下来需要做的事情："></a>总结一下整个流程下来需要做的事情：</h3><ol>
<li>搭建MIT kerberos，注意保存cloudera-scm/admin密码。</li>
<li>集群启用kerberos</li>
<li>删除所有node manager上yarn cache，/yarn/nm/usercache/</li>
<li>客户端配置</li>
<li>周边服务配置: opentsdb升级到2.2，加入jaas, flume配置升级</li>
<li>验证MapReduce, spark, hive, impala, sqoop, oozie, shell脚本的正确性</li>
</ol>
<h3 id="启用和禁用kerberos过程中的问题"><a href="#启用和禁用kerberos过程中的问题" class="headerlink" title="启用和禁用kerberos过程中的问题"></a>启用和禁用kerberos过程中的问题</h3><ol>
<li>如果有跨集群操作，最好不要启用kerberos，distcp命令时会报错。参考<a href="https://issues.apache.org/jira/browse/HDFS-7037" target="_blank" rel="external">https://issues.apache.org/jira/browse/HDFS-7037</a></li>
<li>集群需要停机一段时间</li>
<li>禁用kerberos后恢复hbase需要一段时间</li>
<li>HA下yarn两个resource manager都处于standby状态，只能禁用HA</li>
</ol>
<h2 id="MIT-kerberos搭建"><a href="#MIT-kerberos搭建" class="headerlink" title="MIT kerberos搭建"></a>MIT kerberos搭建</h2><p>公司内部使用的是<code>Microsoft Active Directory</code>，但由于不给创建用户权限，而且用户名必须符合一定格式，修改现存集群的账号太过麻烦，所以自己搭建了<code>MIT kerberos</code>。<br>参考<a href="http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs" target="_blank" rel="external">http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs</a></p>
<p>在这纪录一下用到的一些命令，具体配置和步骤参考上文。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装kerberos server</span></div><div class="line">yum install krb5-server -y</div><div class="line">yum install krb5-libs krb5-workstation -y</div><div class="line"></div><div class="line"><span class="comment"># 停止服务</span></div><div class="line">service krb5kdc stop</div><div class="line">service kadmin stop</div><div class="line"></div><div class="line"><span class="comment"># 删除数据库文件和一些配置</span></div><div class="line">rm <span class="_">-f</span> /var/kerberos/krb5kdc/principal*</div><div class="line">rm <span class="_">-f</span> /var/kerberos/krb5kdc/.k5.*</div><div class="line">rm <span class="_">-f</span> /etc/krb5.keytab</div><div class="line"></div><div class="line"><span class="comment"># 修改配置</span></div><div class="line"><span class="comment">## 注意最后的*之间有一个空格</span></div><div class="line">vim /var/kerberos/krb5kdc/kadm5.acl</div><div class="line">vim /var/kerberos/krb5kdc/kdc.conf</div><div class="line"><span class="comment"># 此配置需要同步到其他机器上，如果使用cloudera，可以让cloudera接管</span></div><div class="line">vim /etc/krb5.conf</div><div class="line"></div><div class="line"><span class="comment"># 创建数据库</span></div><div class="line">kdb5_util create -r HADOOP.COM <span class="_">-s</span></div><div class="line"></div><div class="line"><span class="comment"># 启动服务</span></div><div class="line">service krb5kdc start</div><div class="line">service kadmin start</div><div class="line"></div><div class="line"><span class="comment"># 添加root用户</span></div><div class="line"><span class="built_in">echo</span> <span class="_">-e</span> <span class="string">"root\nroot"</span> | kadmin.local -q <span class="string">"addprinc root/admin"</span></div><div class="line"></div><div class="line"><span class="comment"># 抽取密钥并将其储存在本地 keytab 文件 /etc/krb5.keytab 中。这个文件由超级用户拥有，所以您必须是 root 用户才能在 kadmin shell 中执行以下命令</span></div><div class="line">kadmin.local -q <span class="string">"ktadd kadmin/admin"</span></div><div class="line">klist -k /etc/krb5.keytab</div><div class="line"></div><div class="line"><span class="comment"># 生成cloudera中使用的admin账号</span></div><div class="line">kadmin.local -q <span class="string">"addprinc -pw cloudera cloudera-scm/admin@HADOOP.COM"</span></div><div class="line"></div><div class="line"><span class="comment"># 生成用户账号keytab</span></div><div class="line">kadmin.local -q <span class="string">"xst -k <span class="variable">$&#123;USERNAME&#125;</span>.keytab <span class="variable">$&#123;USERNAME&#125;</span>@HADOOP.COM"</span></div><div class="line"><span class="comment"># 合并keytab</span></div><div class="line">$ ktutil</div><div class="line">ktutil: rkt hdfs-unmerged.keytab</div><div class="line">ktutil: rkt HTTP.keytab</div><div class="line">ktutil: wkt hdfs.keytab</div><div class="line">ktutil: <span class="built_in">exit</span></div><div class="line"><span class="comment"># 使用keytab切换用户</span></div><div class="line">kinit -k -t hdfs.keytab hdfs@HADOOP.COM  </div><div class="line">kinit -k -t hdfs.keytab hdfs</div><div class="line"></div><div class="line"><span class="comment"># 删除principal，不交互的话可以加'-force'参数</span></div><div class="line">kadmin.local -q <span class="string">"delprinc <span class="variable">$princ</span>"</span></div></pre></td></tr></table></figure></p>
<h3 id="What’s-a-keytab-file"><a href="#What’s-a-keytab-file" class="headerlink" title="What’s a keytab file?"></a>What’s a keytab file?</h3><blockquote>
<p>What’s a keytab file?  It’s basically a file that contains a table of user accounts, with an encrypted hash of the user’s password.  Why have a keytab file?  Well, when you want a server process to automatically logon to Active Directory on startup, you have two options:  type the password (in clear text) into a config file somewhere, or store an encrypted hash of the password in a keytab file.</p>
</blockquote>
<h2 id="CDH启用kerberos"><a href="#CDH启用kerberos" class="headerlink" title="CDH启用kerberos"></a>CDH启用kerberos</h2><p>参考<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera官网: Enabling Kerberos Authentication Using the Wizard</a></p>
<h3 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h3><h4 id="CDH-Manager-Server上安装openldap-clients"><a href="#CDH-Manager-Server上安装openldap-clients" class="headerlink" title="CDH Manager Server上安装openldap-clients"></a>CDH Manager Server上安装<code>openldap-clients</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo yum install openldap-clients</div></pre></td></tr></table></figure>
<h4 id="集群所有机器上安装krb5-workstation-krb5-libs"><a href="#集群所有机器上安装krb5-workstation-krb5-libs" class="headerlink" title="集群所有机器上安装krb5-workstation, krb5-libs"></a>集群所有机器上安装<code>krb5-workstation, krb5-libs</code></h4><p>cloudera manager server可以ssh无密码登陆到其他机器上<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> `cat /etc/hosts | fgrep 172 | awk <span class="string">'&#123;print $1&#125;'</span>`; <span class="keyword">do</span></div><div class="line">  sudo yum install krb5-workstation krb5-libs -y </div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<h4 id="生成cloudera中使用的admin账号"><a href="#生成cloudera中使用的admin账号" class="headerlink" title="生成cloudera中使用的admin账号"></a>生成cloudera中使用的admin账号</h4><p>密码要记牢，此账号需要有权限创建其他账号</p>
<blockquote>
<p>Specifically, the Cloudera Manager Server must have a Kerberos principal that has privileges to create other accounts.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin.local -q <span class="string">"addprinc -pw &lt;Password&gt; cloudera-scm/admin@YOUR-LOCAL-REALM.COM"</span></div></pre></td></tr></table></figure>
<h3 id="CDH启用kerberos-1"><a href="#CDH启用kerberos-1" class="headerlink" title="CDH启用kerberos"></a>CDH启用kerberos</h3><p>在CDH管理页面，集群名称右侧的小三角下拉菜单中，选择「启用Kerberos」，然后按<a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_s4_kerb_wizard.html" target="_blank" rel="external">Enabling Kerberos Using the Wizard</a>一步步操作即可。</p>
<p><strong> 针对yarn配置，需要做下面的修改：</strong><br>配置文件container-executor.cfg</p>
<ol>
<li><code>min.user.id</code>: 允许的最小 Linux 用户 ID, 用于阻止其他超级用户，默认是1000。</li>
<li><code>allowed.system.users</code>: 明确列入白名单以允许运行容器的用户列表。可以使用该设置将 ID 低于“最小用户 ID”设置的用户列入白名单。</li>
<li><code>banned.users</code>: 禁止运行容器的用户列表。</li>
<li>格式化resourcemanager state store</li>
</ol>
<blockquote>
<p> Important:<br>If you have enabled YARN Resource Manager HA in your non-secure cluster, you should clear the StateStore znode in ZooKeeper before enabling Kerberos. To do this:</p>
<ol>
<li>Go to the Cloudera Manager Admin Console home page, click to the right of the YARN service and select Stop.</li>
<li>When you see a Finished status, the service has stopped.</li>
<li>Go to the YARN service and select Actions &gt; Format State Store.</li>
<li>When the command completes, click Close.</li>
</ol>
</blockquote>
<h2 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h2><h3 id="创建hdfs超级用户"><a href="#创建hdfs超级用户" class="headerlink" title="创建hdfs超级用户"></a>创建hdfs超级用户</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin.local -q &quot;addprinc hdfs@HADOOP.COM&quot;</div></pre></td></tr></table></figure>
<p>密码强度大一点，此用户拥有hdfs上所有权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kinit hdfs@HADOOP.COM</div></pre></td></tr></table></figure>
<p>切换到此用户。</p>
<h3 id="指定hdfs超级用户组"><a href="#指定hdfs超级用户组" class="headerlink" title="指定hdfs超级用户组"></a>指定hdfs超级用户组</h3><blockquote>
<p>To designate a group of superusers instead of using the default hdfs account, follow these steps:</p>
<ol>
<li>Navigate to the <strong>HDFS Service</strong> &gt; <strong>Configuration</strong> tab.</li>
<li>In the Search field, type <strong>Superuser</strong> to display the <strong>Superuser Group</strong> property.</li>
<li>Change the value from the default supergroup to the appropriate group name for your environment.</li>
<li>Click <strong>Save Changes</strong>.<br>For this change to take effect, you must restart the cluster.</li>
</ol>
</blockquote>
<h3 id="为每个用户创建principal"><a href="#为每个用户创建principal" class="headerlink" title="为每个用户创建principal"></a>为每个用户创建principal</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kadmin.local -q &quot;addprinc user@HADOOP.COM&quot;</div></pre></td></tr></table></figure>
<p><a href="http://www.cloudera.com/documentation/enterprise/latest/topics/cm_sg_s7_prepare_cluster.html" target="_blank" rel="external">Prepare the Cluster for Each User</a></p>
<blockquote>
<p>Each account must have a user ID that is greater than or equal to 1000. In the /etc/hadoop/conf/taskcontroller.cfg file, the default setting for the banned.users property is mapred, hdfs, and bin to prevent jobs from being submitted via those user accounts. The default setting for the min.user.id property is 1000 to prevent jobs from being submitted with a user ID less than 1000, which are conventionally Unix super users.</p>
</blockquote>
<h2 id="周边服务"><a href="#周边服务" class="headerlink" title="周边服务"></a>周边服务</h2><h3 id="opentsdb连接集成了kerberos的hbase"><a href="#opentsdb连接集成了kerberos的hbase" class="headerlink" title="opentsdb连接集成了kerberos的hbase"></a>opentsdb连接集成了kerberos的hbase</h3><p>下载使用最新的opentsdb 2.2版本，此前版本中集成的AsyncHBase无kerberos验证功能。</p>
<ol>
<li><p>在/etc/opentsdb/opentsdb.conf中添加如下配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hbase.security.auth.enable=true</div><div class="line">hbase.security.authentication=kerberos</div><div class="line">hbase.kerberos.regionserver.principal=hbase/_HOST@HADOOP.COM</div><div class="line">hbase.sasl.clientconfig=Client</div></pre></td></tr></table></figure>
</li>
<li><p>新建/etc/opentsdb/jaas.conf，内容如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Client &#123;</div><div class="line">  com.sun.security.auth.module.Krb5LoginModule required</div><div class="line">  useKeyTab=false</div><div class="line">  useTicketCache=true;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>在opentsdb启动项中添加<code>-Djava.security.auth.login.config=/etc/opentsdb/jaas.conf</code>。</p>
</li>
<li>运行<code>kinit</code>命令：<code>kinit -k -t hbase.keytab hbase</code></li>
<li>重启opentsdb</li>
</ol>
<p>如果使用keytab方式会报无法连接hbase的错误，所以使用<code>useTicketCache</code>，并手动<code>kinit</code>。</p>
<blockquote>
<p>KerberosClientAuthProvider: Could not login: the client is being asked for a password, but the  client code does not currently support obtaining a password from the user. Make sure that the client is configured to use a ticket cache (using the JAAS configuration setting ‘useTicketCache=true)’ and restart the client. If you still get this message after that, the TGT in the ticket cache has expired and must be manually refreshed. To do so, first determine if you are using a password or a keytab. If the former, run kinit in a Unix shell in the environment of the user who is running this asynchbase client using the command ‘kinit <princ>‘ (where <princ> is the name of the client’s Kerberos principal). If the latter, do ‘kinit -k -t <keytab> <princ>‘ (where <princ> is the name of the Kerberos principal, and <keytab> is the location of the keytab file). After manually refreshing your cache, restart this client. If you continue to see this message after manually refreshing your cache, ensure that your KDC host’s clock is in sync with this host’s clock.</keytab></princ></princ></keytab></princ></princ></p>
</blockquote>
<h3 id="flume连接集成了kerberos的hdfs"><a href="#flume连接集成了kerberos的hdfs" class="headerlink" title="flume连接集成了kerberos的hdfs"></a>flume连接集成了kerberos的hdfs</h3><p>将hdfs.keytab复制到flume conf目录下，并在flume.hdfs.conf中配置hdfs-sink，添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a1.sinks.hdfs-sink.hdfs.kerberosPrincipal = hdfs@HADOOP.COM</div><div class="line">a1.sinks.hdfs-sink.hdfs.kerberosKeytab = ./conf/hdfs.keytab</div></pre></td></tr></table></figure></p>
<p>注意keytab位置。</p>
<h2 id="异常信息和解决方法"><a href="#异常信息和解决方法" class="headerlink" title="异常信息和解决方法"></a>异常信息和解决方法</h2><h3 id="1-kinit-Cannot-find-KDC-for-requested-realm-while-getting-initial-credentials"><a href="#1-kinit-Cannot-find-KDC-for-requested-realm-while-getting-initial-credentials" class="headerlink" title="1. kinit: Cannot find KDC for requested realm while getting initial credentials"></a>1. kinit: Cannot find KDC for requested realm while getting initial credentials</h3><p>krb5.conf配置不正确，可以考虑cloudera接管krb5.conf</p>
<h3 id="2-kinit-KDC-reply-did-not-match-expectations-while-getting-initial-credentials"><a href="#2-kinit-KDC-reply-did-not-match-expectations-while-getting-initial-credentials" class="headerlink" title="2. kinit: KDC reply did not match expectations while getting initial credentials"></a>2. kinit: KDC reply did not match expectations while getting initial credentials</h3><p>kerberos配置时域名要大写</p>
<h3 id="3-机器hostname引起的最大的坑！"><a href="#3-机器hostname引起的最大的坑！" class="headerlink" title="3. 机器hostname引起的最大的坑！"></a>3. 机器hostname引起的最大的坑！</h3><p>症状: 集群中hdfs等服务无法启动,报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">java.io.IOException: Login failure for hdfs/vlnx107010@HADOOP.COM from keytab hdfs.keytab: javax.security.auth.login.LoginException: Client not found in Kerberos database (6) - CLIENT_NOT_FOUND</div><div class="line">    at org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytab(UserGroupInformation.java:976)</div><div class="line">    at org.apache.hadoop.security.SecurityUtil.login(SecurityUtil.java:243)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.loginAsNameNodeUser(NameNode.java:613)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:632)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:810)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:794)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1487)</div><div class="line">    at org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:1555)</div><div class="line">Caused by: javax.security.auth.login.LoginException: Client not found in Kerberos database (6) - CLIENT_NOT_FOUND</div><div class="line">    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:804)</div><div class="line">    at com.sun.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:617)</div><div class="line">    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</div><div class="line">    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</div><div class="line">    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">    at java.lang.reflect.Method.invoke(Method.java:497)</div><div class="line">    at javax.security.auth.login.LoginContext.invoke(LoginContext.java:755)</div><div class="line">    at javax.security.auth.login.LoginContext.access$000(LoginContext.java:195)</div><div class="line">    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:682)</div><div class="line">    at javax.security.auth.login.LoginContext$4.run(LoginContext.java:680)</div><div class="line">    at java.security.AccessController.doPrivileged(Native Method)</div><div class="line">    at javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)</div><div class="line">    at javax.security.auth.login.LoginContext.login(LoginContext.java:587)</div><div class="line">    at org.apache.hadoop.security.UserGroupInformation.loginUserFromKeytab(UserGroupInformation.java:967)</div><div class="line">    ... 7 more</div><div class="line">Caused by: KrbException: Client not found in Kerberos database (6) - CLIENT_NOT_FOUND</div><div class="line">    at sun.security.krb5.KrbAsRep.&lt;init&gt;(KrbAsRep.java:82)</div><div class="line">    at sun.security.krb5.KrbAsReqBuilder.send(KrbAsReqBuilder.java:316)</div><div class="line">    at sun.security.krb5.KrbAsReqBuilder.action(KrbAsReqBuilder.java:361)</div><div class="line">    at com.sun.security.auth.module.Krb5LoginModule.attemptAuthentication(Krb5LoginModule.java:776)</div><div class="line">    ... 20 more</div><div class="line">Caused by: KrbException: Identifier doesn&apos;t match expected value (906)</div><div class="line">    at sun.security.krb5.internal.KDCRep.init(KDCRep.java:140)</div><div class="line">    at sun.security.krb5.internal.ASRep.init(ASRep.java:64)</div><div class="line">    at sun.security.krb5.internal.ASRep.&lt;init&gt;(ASRep.java:59)</div><div class="line">    at sun.security.krb5.KrbAsRep.&lt;init&gt;(KrbAsRep.java:60)</div><div class="line">    ... 23 more</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">klist -k hdfs.keytab</div><div class="line">Keytab name: FILE:hdfs.keytab</div><div class="line">KVNO Principal</div><div class="line">---- --------------------------------------------------------------------------</div><div class="line">   2 HTTP/VLNX107010@HADOOP.COM</div><div class="line">   2 HTTP/VLNX107010@HADOOP.COM</div><div class="line">   2 HTTP/VLNX107010@HADOOP.COM</div><div class="line">   2 HTTP/VLNX107010@HADOOP.COM</div><div class="line">   2 hdfs/VLNX107010@HADOOP.COM</div><div class="line">   2 hdfs/VLNX107010@HADOOP.COM</div><div class="line">   2 hdfs/VLNX107010@HADOOP.COM</div><div class="line">   2 hdfs/VLNX107010@HADOOP.COM</div></pre></td></tr></table></figure>
<p>注意hdfs日志中principal为<code>hdfs/vlnx107010@HADOOP.COM</code>，但在生成的hdfs.keytab中为<code>hdfs/VLNX107010@HADOOP.COM</code>，区别就是域名的大小写，在kerberos中是区分大小写的，所以认证失败。</p>
<p>此集群的hostname和/etc/hosts中都是大写的，所以第一想法是想办法将hdfs的principal改为小写的，经过各种尝试和查阅资料后，发现不可行，参考<a href="https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475" target="_blank" rel="external">https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475</a></p>
<blockquote>
<p>Hadoop in general expects that your hostnames and domain names are all lowercase.  When Kerberos is introduced, this becomes important.  While it is possible to override this behavior (of expecting lowercase) by doing manual configuration, I recommend ensuring via /etc/hosts or DNS that your host and domain are lower case.  After that is corrected, regenerate credentials and that should correct the problem.</p>
</blockquote>
<p>进行了更为苦逼的三步：<br>1。修改集群的hostname和/etc/hosts了，修改一台机器的/etc/hosts后，批量处理<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> HOST <span class="keyword">in</span> `cat /etc/hosts | fgrep 172 | awk <span class="string">'&#123;print $2&#125;'</span>`; <span class="keyword">do</span></div><div class="line">    scp /etc/hosts <span class="variable">$&#123;HOST&#125;</span>:/etc/hosts</div><div class="line">    ssh <span class="variable">$&#123;HOST&#125;</span> <span class="string">"hostname <span class="variable">$&#123;HOST&#125;</span> &amp;&amp; sed -i 's/VLNX/vlnx/g' /etc/sysconfig/network"</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>在cloudera中按照上面步骤disable kerberos，然后重新配置一次。发现还是不行，在kerberos中生成的用户还是大写的。</p>
<p>2。于是修改kerberos中账号名，将VLNX修改为vlnx。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> P <span class="keyword">in</span> `kadmin.local -q <span class="string">"listprincs"</span> | fgrep VLNX` ; <span class="keyword">do</span></div><div class="line">    UP=`<span class="built_in">echo</span> <span class="variable">$P</span> | sed <span class="string">'s/VLNX/vlnx/g'</span> ` </div><div class="line">    kadmin.local -q <span class="string">"renprinc -force <span class="variable">$&#123;P&#125;</span> <span class="variable">$&#123;UP&#125;</span>"</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>还是不行，这是在我预料中的，因为在生成的keytab中账号名还是大写的。参考上面的<code>klist -k hdfs.keytab</code>命令结果。</p>
<p>3。终极解决方案来了。cloudera中kerberos生成凭证取的是在cloudera数据库中保存的主机名，所以需要修改cloudera主机名，在页面中没有找到可以修改主机名的地方，只能通过数据库修改。</p>
<p>cloudera自身使用的数据库是<code>postgres</code>，database为<code>scm</code>，密码在<code>/etc/cloudera-scm-server/db.properties</code>中。通过<code>psql -h localhost -p 7432 -U scm</code>进入postgres cli。</p>
<p>查看hosts，并修改name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">scm=&gt;  select host_id,host_identifier,name,ip_address from hosts;</div><div class="line"> host_id |           host_identifier            |    name    |   ip_address</div><div class="line">---------+--------------------------------------+------------+----------------</div><div class="line">       1 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107009 | 192.1.107.9</div><div class="line">       2 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107010 | 192.1.107.10</div><div class="line">       9 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103122 | 192.1.103.122</div><div class="line">       7 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103124 | 192.1.103.124</div><div class="line">       8 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103125 | 192.1.103.125</div><div class="line">       6 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103126 | 192.1.103.126</div><div class="line">       5 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103127 | 192.1.103.127</div><div class="line">       4 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103128 | 192.1.103.128</div><div class="line">      12 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX103129 | 192.1.103.129</div><div class="line">       3 | xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx | VLNX107011 | 192.1.107.11</div><div class="line"></div><div class="line">scm=&gt;  update hosts set name = &apos;vlnx107011&apos; where host_id = 3;</div></pre></td></tr></table></figure></p>
<p>全部更新完成后，重启cloudera-scm-server和所有机器的cloudera-scm-agent，然后再重新来一遍。</p>
<h3 id="4-跨集群distcp异常"><a href="#4-跨集群distcp异常" class="headerlink" title="4. 跨集群distcp异常"></a>4. 跨集群distcp异常</h3><p>从一个非安全集群拷贝数据到安全集群存在问题，参考<a href="https://issues.apache.org/jira/browse/HDFS-7037" target="_blank" rel="external">https://issues.apache.org/jira/browse/HDFS-7037</a><br>此问题还未得到解决，由于我们有两个集群，并且会进行集群间数据交互，所以最后未启用kerberos。</p>
<h3 id="5-yarn中任务报错”用户id小于1000”"><a href="#5-yarn中任务报错”用户id小于1000”" class="headerlink" title="5. yarn中任务报错”用户id小于1000”"></a>5. yarn中任务报错”用户id小于1000”</h3><p>Diagnostics: Application application_1453449921629_0005 initialization failed (exitCode=255) with output: Requested user hdfs is not whitelisted and has id 496, which is below the minimum allowed 1000</p>
<p>用户在client上id不能小于1000，可以在<code>container-executor.cfg</code>配置<code>min.user.id</code>，或者修改linux的<code>/etc/login.defs</code>中<code>UID_MIN</code>大小。</p>
<h3 id="6-yarn中跑任务时报错User-lt-user-gt-not-found"><a href="#6-yarn中跑任务时报错User-lt-user-gt-not-found" class="headerlink" title="6. yarn中跑任务时报错User &lt;user&gt; not found"></a>6. yarn中跑任务时报错<code>User &lt;user&gt; not found</code></h3><p>异常信息: <code>Diagnostics: Application application_1453449921629_0004 initialization failed (exitCode=255) with output: User usertest not found</code></p>
<p>解决方案：需要所有nodemanager上有相应的用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">useradd -m usertest &amp;&amp; echo &lt;password&gt; | passwd --stdin usertest</div></pre></td></tr></table></figure></p>
<h3 id="7-yarn报错Can-39-t-create-directory-yarn-nm-usercache-Permission-denied"><a href="#7-yarn报错Can-39-t-create-directory-yarn-nm-usercache-Permission-denied" class="headerlink" title="7. yarn报错Can&#39;t create directory /yarn/nm/usercache/... Permission denied"></a>7. yarn报错<code>Can&#39;t create directory /yarn/nm/usercache/... Permission denied</code></h3><p>异常信息： <code>Can&#39;t create directory /yarn/nm/usercache/usertest/appcache/application_1453549225084_0001 - Permission denied. Did not create any app directories</code></p>
<p>解决方法：<br>手动删除所有nodemanager的<code>/yarn/nm/usercache/</code>下内容。</p>
<p>注意不能删除整个usercache目录，否则会报<code>Failed to create directory /yarn/nm/usercache/usertest - No such file or directory</code>。报这个错时，只要再新建这个目录，并chown给yarn。</p>
<p>参考：<a href="http://community.cloudera.com/t5/Batch-Processing-and-Workflow/Can-t-create-directory-yarn-nm-usercache-urika-appcache/td-p/24891" target="_blank" rel="external">http://community.cloudera.com/t5/Batch-Processing-and-Workflow/Can-t-create-directory-yarn-nm-usercache-urika-appcache/td-p/24891</a></p>
<blockquote>
<p>Fix was to remove or move the urika cache directory from all the nodes with (computes in my case).  Seems that these directories will get re-created during a run.<br>Bug when you go from simlpe AUTH to kerberos AUTH; the cache directories will not work if created under simple AUTH.</p>
</blockquote>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://www.cloudera.com/content/www/en-us/documentation/enterprise/latest/topics/cm_sg_intro_kerb.html" target="_blank" rel="external">Cloudera官网: Enabling Kerberos Authentication Using the Wizard</a></li>
<li><a href="http://blog.javachen.com/2014/11/04/config-kerberos-in-cdh-hdfs" target="_blank" rel="external">HDFS配置Kerberos认证</a></li>
<li><a href="http://www.aboutyun.com/thread-13346-1-1.html" target="_blank" rel="external">CDH配置Kerberos后的问题</a></li>
<li><a href="http://www.aikaiyuan.com/1380.html" target="_blank" rel="external">Linux加入域kinit命令验证错误解答</a></li>
<li><a href="http://www.itadmintools.com/2011/07/creating-kerberos-keytab-files.html" target="_blank" rel="external">Creating Kerberos Keytab Files Compatible with Active Directory</a></li>
<li><a href="https://community.cloudera.com/t5/Cloudera-Manager-Installation/javax-security-auth-login-LoginException-Client-not-found-in/td-p/30475" target="_blank" rel="external">cloudera kerberos hostname大小写问题</a></li>
<li><a href="http://linsec.ca/using_kerberos_5_for_single_sign-on_authentication/" target="_blank" rel="external">Using kerberos5 for single sign on authentication</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://wzktravel.github.io/2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/" data-id="ciqlv6tw6001apo9kd3uxfals" class="article-share-link">分享到</a>
      

      
        <a href="http://wzktravel.github.io/2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CDH/">CDH</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kerberos/">kerberos</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/01/19/2016-01-19-hdfs-add-nodes-dynamically/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          HFDS修改备份系数和动态增删节点
        
      </div>
    </a>
  
  
    <a href="/2016/01/15/2016-01-15-ntp-server/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">ntp server搭建</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/" data-title="Cloudera启用kerberos" data-url="http://wzktravel.github.io/2016/01/19/2016-01-19-Enabling-Kerberos-In-CDH/"></div>
  </section>
</section>
      
      <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDH/">CDH</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azkaban/">azkaban</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cdh/">cdh</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloudera/">cloudera</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdfs/">hdfs</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/">hive</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/">jvm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kerberos/">kerberos</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/">lambda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/">log</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lzo/">lzo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ntp/">ntp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/">quartz</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/queue/">queue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">scala</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sed/">sed</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentry/">sentry</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/">spark</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yarn/">yarn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/任务调度/">任务调度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调度/">调度</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CDH/" style="font-size: 15px;">CDH</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/azkaban/" style="font-size: 10px;">azkaban</a> <a href="/tags/cdh/" style="font-size: 11.67px;">cdh</a> <a href="/tags/cloudera/" style="font-size: 11.67px;">cloudera</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/flume/" style="font-size: 11.67px;">flume</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 11.67px;">github</a> <a href="/tags/hadoop/" style="font-size: 20px;">hadoop</a> <a href="/tags/hdfs/" style="font-size: 13.33px;">hdfs</a> <a href="/tags/hive/" style="font-size: 11.67px;">hive</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/kerberos/" style="font-size: 13.33px;">kerberos</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/lzo/" style="font-size: 10px;">lzo</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/ntp/" style="font-size: 10px;">ntp</a> <a href="/tags/quartz/" style="font-size: 10px;">quartz</a> <a href="/tags/queue/" style="font-size: 10px;">queue</a> <a href="/tags/scala/" style="font-size: 13.33px;">scala</a> <a href="/tags/sed/" style="font-size: 10px;">sed</a> <a href="/tags/sentry/" style="font-size: 10px;">sentry</a> <a href="/tags/shell/" style="font-size: 18.33px;">shell</a> <a href="/tags/spark/" style="font-size: 13.33px;">spark</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/vim/" style="font-size: 11.67px;">vim</a> <a href="/tags/yarn/" style="font-size: 10px;">yarn</a> <a href="/tags/任务调度/" style="font-size: 10px;">任务调度</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/调度/" style="font-size: 10px;">调度</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/05/24/2016-05-24-upgrade-cdh-to-5-7-0/">升级CDH到5.7.0</a>
          </li>
        
          <li>
            <a href="/2016/05/11/2016-05-11-elasticsearch-reindex/">elasticsearch修改mapping重建索引</a>
          </li>
        
          <li>
            <a href="/2016/05/10/2016-05-10-hadoop-management/">hadoop集群管理</a>
          </li>
        
          <li>
            <a href="/2016/05/04/2016-05-04-azkaban-how-to-install-and-use/">azkaban的安装和使用</a>
          </li>
        
          <li>
            <a href="/2016/04/14/2016-04-14-quartz-in-practice/">quartz in practice</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 wzktravel<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"wzktravel"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js"></script>

</div>
</body>
</html>
